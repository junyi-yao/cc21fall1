# Customized Sorting in R

Xuchen Wang



The idea of this package comes from the lack of sorting function in R, which uses the order function to sort and really caused some confusion for me. In addition, user defined functions are not applicable, so I would like to implement the sort function by myself. 

I am using the idea of merge sort for these sorting functions which runs in O(nlogn).

This file contains two functions, aiming to solve the following question

(1) sort a list with user-defined comparison function

eg: 

lst=[[2,2,8],[3,6,7],[9,5,2]], 

compare<-function(x,y) {
  x[[2]]<y[[2]]
}

lst<-sort(lst,compare)

lst would be [[2,2,8],[9,5,2],[3,6,7]] now



```r
lstmerge<-function(l1,l2,comp) {
  m<-length(l1)
  n<-length(l2)
  i<-1
  j<-1
  output<-vector("list",m+n)
  while(i<=m&&j<=n) {
    if(comp(l1[[i]],l2[[j]])) {
      output[[i+j-1]]<-l1[[i]]
      i<-i+1
    } else {
      output[[i+j-1]]<-l2[[j]]
      j<-j+1
    }
  }
  while(i<=m) {
     output[[i+j-1]]<-l1[[i]]
    i<-i+1
  }
   while(j<=n) {
     output[[i+j-1]]<-l2[[j]]
    j<-j+1
   }
  output
}

lstsort<-function(lst,comp) {
  n<-length(lst)
  if(n<=1) {
    return(lst)
  }
  mid<-ceiling(n/2)
  lft<-lstsort(lst[(1:mid)],comp)
  rt<-lstsort(lst[((mid+1):n)],comp)
  return(lstmerge(lft,rt,comp))
  
}
```




example:






```r
lst= lapply(1:100, function(x) as.list(sample(1:100,size=2)))
sapply(lst,function(x) x[[2]])
```

```
##   [1]  62  78  55   5  87  84  54  81  70  69  25  60 100  50  61   1  23  29
##  [19]  78  28  56  84  39  92  36  56  68  38  63  35  68   7 100  87  78  61
##  [37]  78   3   9  59  95  28  78  94  14  48  21  23  50  90  79  53  33  76
##  [55]  91  88  98  22  98  34  45  33  98  85   9  73   7  44  58  41  85  30
##  [73]  19  24  19  90  74  35  50  45 100  94  36  21  35  34  14  15  40  19
##  [91]   4  84   8  26  34   9  37  36  26  34
```



```r
compare<-function(x,y) {
  x[[2]]<y[[2]]
}

lst<-lstsort(lst,compare)
sapply(lst,function(x) x[[2]])
```

```
##   [1]   1   3   4   5   7   7   8   9   9   9  14  14  15  19  19  19  21  21
##  [19]  22  23  23  24  25  26  26  28  28  29  30  33  33  34  34  34  34  35
##  [37]  35  35  36  36  36  37  38  39  40  41  44  45  45  48  50  50  50  53
##  [55]  54  55  56  56  58  59  60  61  61  62  63  68  68  69  70  73  74  76
##  [73]  78  78  78  78  78  79  81  84  84  84  85  85  87  87  88  90  90  91
##  [91]  92  94  94  95  98  98  98 100 100 100
```


to sort a list of vector just change the compare function:


```r
lst= lapply(1:100, function(x) sample(1:100,size=2))
sapply(lst,function(x) x[2])
```

```
##   [1]  43  38  49  99   7  47  45  75  49  73   9   9  13  45  15  93   9  78
##  [19]  92  88   4  93  31  73  41  71  47  23  11  19  12   2  98  11  75  17
##  [37]  94  37  94  42  94  34  90  73  19  81  39  90  38  63   7  97   5  57
##  [55]  36  76  23  54  22  23  74  71  21  21  64  46  93  27  87  45 100  23
##  [73]  80  55  72   2  33  79  88  33  30  61  59  35  91  56  76  23  45  44
##  [91]  98   7  15  53  31   6  96  89  56  11
```



```r
compare2<-function(x,y) {
  x[2]<y[2]
}
lst<-lstsort(lst,compare2)
sapply(lst,function(x) x[2])
```

```
##   [1]   2   2   4   5   6   7   7   7   9   9   9  11  11  11  12  13  15  15
##  [19]  17  19  19  21  21  22  23  23  23  23  23  27  30  31  31  33  33  34
##  [37]  35  36  37  38  38  39  41  42  43  44  45  45  45  45  46  47  47  49
##  [55]  49  53  54  55  56  56  57  59  61  63  64  71  71  72  73  73  73  74
##  [73]  75  75  76  76  78  79  80  81  87  88  88  89  90  90  91  92  93  93
##  [91]  93  94  94  94  96  97  98  98  99 100
```









(2) sort a dataframe with user-defined function


The logic is the same as above, the only thing to notice is that the comparison function takes two rows and compare them





```r
dfmerge<-function(d1,d2,comp) {
  m<-nrow(d1)
  n<-nrow(d2)
  i<-1
  j<-1
  output<-data.frame(matrix(NA,nrow=m+n,ncol=length(colnames(d1))))
  colnames(output)<-colnames(d1)
 while(i<=m&&j<=n) {
    if(comp(d1[i,],d2[j,])) {
      output[(i+j-1),]<-d1[i,]
      i<-i+1
    } else {
      output[(i+j-1),]<-d2[j,]
      j<-j+1
    }
  }
  while(i<=m) {
     output[(i+j-1),]<-d1[i,]
      i<-i+1
  }
   while(j<=n) {
    output[(i+j-1),]<-d2[j,]
      j<-j+1
   }
  output
  
}

dfsort<-function(df,comp) {
  n<-nrow(df)
  if(n<=1) {
    return(df)
  }
  mid<-ceiling(n/2)
  lft<-dfsort(df[1:mid,],comp)
  rt<-dfsort(df[(mid+1):n,],comp)
  return(dfmerge(lft,rt,comp))
  
}
```





```r
M<-matrix(sample(1:100,300,replace=TRUE),ncol=3)
df<-data.frame(M)
colnames(df)<-c("a","b","c")
df
```

```
##      a  b   c
## 1   82 46  69
## 2   49 94  55
## 3   20 17 100
## 4   16 75  69
## 5   68 27  73
## 6   57 13  26
## 7   97  7  71
## 8   21 15  63
## 9   56 86  94
## 10  94 82  18
## 11   6 92   2
## 12   7 28  64
## 13   9 90  94
## 14  86 78  73
## 15  69 52  60
## 16  94 83  78
## 17  81 99  90
## 18  91 57  35
## 19  46 53  67
## 20  45 65  58
## 21  44 63  25
## 22  53 33  48
## 23  25 76   6
## 24  95 34  94
## 25  53 32   3
## 26  14 25  72
## 27  48 28  57
## 28  20 26  17
## 29  88 56  39
## 30   7  9  50
## 31  15 20  23
## 32  13 66  98
## 33  97 77  50
## 34  76 48  82
## 35  37 84   4
## 36  53 10  15
## 37  30 90  32
## 38  85 19  44
## 39  10 82  17
## 40   3  5   3
## 41  41 37  42
## 42  31 68  25
## 43  58 83  43
## 44  62 88   7
## 45   1 47  46
## 46  35 75  27
## 47  19 78  86
## 48  11 36  89
## 49  18  8  32
## 50  10 69  40
## 51  49 69  18
## 52  92 17  14
## 53   4 59  56
## 54  90 68  49
## 55   9 69  46
## 56  13 93  92
## 57  80 69  11
## 58  32  6  70
## 59  49  2  36
## 60  31 91  14
## 61  25 98  70
## 62  66 97  52
## 63  21 90  82
## 64  82 41  39
## 65  54 62  55
## 66  99 20  79
## 67  59 15  66
## 68  55 63  90
## 69  28 63  92
## 70  91 24  74
## 71  84 45  90
## 72  39 87  22
## 73  15 86  38
## 74   5 39   8
## 75  91 61  17
## 76  12 63  71
## 77  55 70  83
## 78  63 64  29
## 79  52 67  80
## 80  79 43  99
## 81  98 81  53
## 82  27 42  66
## 83  81 56  81
## 84  50 52  80
## 85  53 27  47
## 86  64 87  65
## 87  52 37  71
## 88   8 92  34
## 89  40 46  10
## 90  80  6  82
## 91  47 59  51
## 92  33 84   6
## 93  33 29  77
## 94  84 66  35
## 95  52 92  30
## 96  49 79  44
## 97  17 50  28
## 98  26 62  72
## 99  56 24  82
## 100 96 26  31
```






```r
dfcomp<-function(r1,r2) {
  r1["b"][1]<r2["b"][1]
}


df<-dfsort(df,dfcomp)
df
```

```
##      a  b   c
## 1   49  2  36
## 2    3  5   3
## 3   80  6  82
## 4   32  6  70
## 5   97  7  71
## 6   18  8  32
## 7    7  9  50
## 8   53 10  15
## 9   57 13  26
## 10  59 15  66
## 11  21 15  63
## 12  92 17  14
## 13  20 17 100
## 14  85 19  44
## 15  99 20  79
## 16  15 20  23
## 17  56 24  82
## 18  91 24  74
## 19  14 25  72
## 20  96 26  31
## 21  20 26  17
## 22  53 27  47
## 23  68 27  73
## 24  48 28  57
## 25   7 28  64
## 26  33 29  77
## 27  53 32   3
## 28  53 33  48
## 29  95 34  94
## 30  11 36  89
## 31  52 37  71
## 32  41 37  42
## 33   5 39   8
## 34  82 41  39
## 35  27 42  66
## 36  79 43  99
## 37  84 45  90
## 38  40 46  10
## 39  82 46  69
## 40   1 47  46
## 41  76 48  82
## 42  17 50  28
## 43  50 52  80
## 44  69 52  60
## 45  46 53  67
## 46  81 56  81
## 47  88 56  39
## 48  91 57  35
## 49  47 59  51
## 50   4 59  56
## 51  91 61  17
## 52  26 62  72
## 53  54 62  55
## 54  12 63  71
## 55  28 63  92
## 56  55 63  90
## 57  44 63  25
## 58  63 64  29
## 59  45 65  58
## 60  84 66  35
## 61  13 66  98
## 62  52 67  80
## 63  90 68  49
## 64  31 68  25
## 65  80 69  11
## 66   9 69  46
## 67  49 69  18
## 68  10 69  40
## 69  55 70  83
## 70  35 75  27
## 71  16 75  69
## 72  25 76   6
## 73  97 77  50
## 74  19 78  86
## 75  86 78  73
## 76  49 79  44
## 77  98 81  53
## 78  10 82  17
## 79  94 82  18
## 80  58 83  43
## 81  94 83  78
## 82  33 84   6
## 83  37 84   4
## 84  15 86  38
## 85  56 86  94
## 86  64 87  65
## 87  39 87  22
## 88  62 88   7
## 89  21 90  82
## 90  30 90  32
## 91   9 90  94
## 92  31 91  14
## 93  52 92  30
## 94   8 92  34
## 95   6 92   2
## 96  13 93  92
## 97  49 94  55
## 98  66 97  52
## 99  25 98  70
## 100 81 99  90
```


